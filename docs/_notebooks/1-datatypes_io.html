

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Data types and IO &mdash; PyNekTools develop documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=16816911"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sem subdomains" href="2-sem_subdomains.html" />
    <link rel="prev" title="InputOutput (I/O)" href="../pages/io.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PyNekTools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pages/datatypes.html">Data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/interpolation.html">Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/io.html">InputOutput (I/O)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples on data types and IO:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Data types and IO</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Import-general-modules">Import general modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Import-modules-from-pynektools">Import modules from pynektools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Mesh">Mesh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Initializing">Initializing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Initializing-an-empty-object">Initializing an empty object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Initializing-from-a-file">Initializing from a file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Initializing-from-a-hexadata-object.">Initializing from a hexadata object.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Initializing-from-an-ndarray">Initializing from an ndarray</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Coef">Coef</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Field">Field</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Initializing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Initializing-an-empty-object.">Initializing an empty object.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">Initializing from a file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Initializing-from-hexadata">Initializing from hexadata</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Writing-out-data">Writing out data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Field-registry">Field registry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Adding-new-fields">Adding new fields</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#From-memory">From memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#From-disk">From disk</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Wrappers">Wrappers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Inspecting-memory-usage">Inspecting memory usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Report">Report</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="2-sem_subdomains.html">Sem subdomains</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-data_compression.html">Data compression</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples on calculus on SEM mesh:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="1-differentiation.html">Derivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="2-integration.html">Integration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples on interpolation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="1-interpolation_to_query_points.html">Interpolation to query points</a></li>
<li class="toctree-l1"><a class="reference internal" href="2-element_interpolation.html">Element distribution interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-interpolation_from_2d_sem_mesh.html">Interpolation from 2D sem mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="5-structured_mesh.html">Generating structured meshes</a></li>
<li class="toctree-l1"><a class="reference internal" href="6-interpolating_file_sequences.html">Interpolating file sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="7-visualizing_pointclouds.html">Visualizing pointclouds</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples on reduced order models:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="1-POD_from_pointclouds.html">POD from pointclouds</a></li>
<li class="toctree-l1"><a class="reference internal" href="2-POD_fft_from_pointclouds.html">POD and fft from pointclouds</a></li>
<li class="toctree-l1"><a class="reference internal" href="2-POD_fft_from_pointclouds.html#Write-out-data">Write out data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples on statistics:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="1-post_processing_mean_fields.html">Processing statistics files</a></li>
<li class="toctree-l1"><a class="reference internal" href="1-post_processing_mean_fields.html#Visualize-the-rotated-mean">Visualize the rotated mean</a></li>
<li class="toctree-l1"><a class="reference internal" href="2-UQ_of_velocity.html">UQ of velocity fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-UQ_of_temperature.html">UQ of temperature fields</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyNekTools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Data types and IO</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_notebooks/1-datatypes_io.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Data-types-and-IO">
<h1>Data types and IO<a class="headerlink" href="#Data-types-and-IO" title="Link to this heading"></a></h1>
<section id="Import-general-modules">
<h2>Import general modules<a class="headerlink" href="#Import-general-modules" title="Link to this heading"></a></h2>
<p>mpi4py is always required when using these tools. Numpy is always good to have if any manipulation is to be done.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import required modules</span>
<span class="kn">from</span> <span class="nn">mpi4py</span> <span class="kn">import</span> <span class="n">MPI</span> <span class="c1">#equivalent to the use of MPI_init() in C</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Get mpi info</span>
<span class="n">comm</span> <span class="o">=</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span>
</pre></div>
</div>
</div>
</section>
<section id="Import-modules-from-pynektools">
<h2>Import modules from pynektools<a class="headerlink" href="#Import-modules-from-pynektools" title="Link to this heading"></a></h2>
<p>In this case we will import all the data types that we currently support, as well as io functions that are required to populate them.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data types</span>
<span class="kn">from</span> <span class="nn">pynektools.datatypes.msh</span> <span class="kn">import</span> <span class="n">Mesh</span>
<span class="kn">from</span> <span class="nn">pynektools.datatypes.coef</span> <span class="kn">import</span> <span class="n">Coef</span>
<span class="kn">from</span> <span class="nn">pynektools.datatypes.field</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">FieldRegistry</span>

<span class="c1"># Readers</span>
<span class="kn">from</span> <span class="nn">pynektools.io.ppymech.neksuite</span> <span class="kn">import</span> <span class="n">preadnek</span><span class="p">,</span> <span class="n">pynekread</span>

<span class="c1"># Writers</span>
<span class="kn">from</span> <span class="nn">pynektools.io.ppymech.neksuite</span> <span class="kn">import</span> <span class="n">pwritenek</span><span class="p">,</span> <span class="n">pynekwrite</span>

<span class="n">fname_2d</span> <span class="o">=</span> <span class="s1">&#39;../data/mixlay0.f00001&#39;</span>
<span class="n">fname_3d</span> <span class="o">=</span> <span class="s1">&#39;../data/rbc0.f00001&#39;</span>
</pre></div>
</div>
</div>
<section id="Mesh">
<h3>Mesh<a class="headerlink" href="#Mesh" title="Link to this heading"></a></h3>
<p>The mesh object is designed to interact with the coordinates of the SEM domain. It goes without saying then, that if a file is used to initialize the object, it must contain the mesh.</p>
<section id="Initializing">
<h4>Initializing<a class="headerlink" href="#Initializing" title="Link to this heading"></a></h4>
<p>The mesh object can be initialized in multiple manners that we have ideantified to be typical when post processing data, here we show some of them.</p>
</section>
</section>
</section>
<section id="Initializing-an-empty-object">
<h2>Initializing an empty object<a class="headerlink" href="#Initializing-an-empty-object" title="Link to this heading"></a></h2>
<p>We can initialize an empty mesh object by just providing the communicator.</p>
<p>Note that at this stage we must indicate if we want to find the connectivity of the points. This is important if later one whishes to average points at element interfaces. Be carefull, however, as it will require more memory.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">msh_2d</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">create_connectivity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">msh_3d</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">create_connectivity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2024-10-04 11:15:26,856 - Mesh - INFO - Initializing empty Mesh object.
2024-10-04 11:15:26,857 - Mesh - INFO - Initializing empty Mesh object.
</pre></div></div>
</div>
</section>
<section id="Initializing-from-a-file">
<h2>Initializing from a file<a class="headerlink" href="#Initializing-from-a-file" title="Link to this heading"></a></h2>
<p>The standard way to initialize the data in a mesh object requires that an empty object is initialized and the the pynekread function is called. This function will take the empty object and read only the data containing the mesh.</p>
<p>One must give the name and the empty object that will hold the data. Aditionally, the type of the data is an input.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pynekread</span><span class="p">(</span><span class="n">fname_2d</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">data_dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">,</span> <span class="n">msh</span><span class="o">=</span><span class="n">msh_2d</span><span class="p">)</span>
<span class="n">pynekread</span><span class="p">(</span><span class="n">fname_3d</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">data_dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">single</span><span class="p">,</span> <span class="n">msh</span><span class="o">=</span><span class="n">msh_3d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2024-10-04 11:15:26,868 - pynekread - INFO - Reading file: ../data/mixlay0.f00001
2024-10-04 11:15:26,875 - Mesh - INFO - Initializing Mesh object from x,y,z ndarrays.
2024-10-04 11:15:26,876 - Mesh - INFO - Initializing common attributes.
2024-10-04 11:15:26,877 - Mesh - INFO - Getting vertices
2024-10-04 11:15:26,878 - Mesh - INFO - Getting edge centers
2024-10-04 11:15:26,886 - Mesh - INFO - Facet centers not available for 2D
2024-10-04 11:15:26,887 - Mesh - INFO - Creating connectivity
2024-10-04 11:15:27,254 - Mesh - INFO - Mesh object initialized.
2024-10-04 11:15:27,255 - Mesh - INFO - Mesh data is of type: float64
2024-10-04 11:15:27,256 - Mesh - INFO - Elapsed time: 0.380877588s
2024-10-04 11:15:27,257 - pynekread - INFO - File read
2024-10-04 11:15:27,258 - pynekread - INFO - Elapsed time: 0.38954081s
2024-10-04 11:15:27,259 - pynekread - INFO - Reading file: ../data/rbc0.f00001
2024-10-04 11:15:27,264 - Mesh - INFO - Initializing Mesh object from x,y,z ndarrays.
2024-10-04 11:15:27,265 - Mesh - INFO - Initializing common attributes.
2024-10-04 11:15:27,265 - Mesh - INFO - Getting vertices
2024-10-04 11:15:27,266 - Mesh - INFO - Getting edge centers
2024-10-04 11:15:27,273 - Mesh - INFO - Getting facet centers
2024-10-04 11:15:27,279 - Mesh - INFO - Creating connectivity
2024-10-04 11:15:27,681 - Mesh - INFO - Mesh object initialized.
2024-10-04 11:15:27,682 - Mesh - INFO - Mesh data is of type: float32
2024-10-04 11:15:27,683 - Mesh - INFO - Elapsed time: 0.419004522s
2024-10-04 11:15:27,684 - pynekread - INFO - File read
2024-10-04 11:15:27,684 - pynekread - INFO - Elapsed time: 0.42567180499999996s
</pre></div></div>
</div>
</section>
<section id="Initializing-from-a-hexadata-object.">
<h2>Initializing from a hexadata object.<a class="headerlink" href="#Initializing-from-a-hexadata-object." title="Link to this heading"></a></h2>
<p>We have previously use the module pymech to post process data. Because of this we wrote io routines that produce objects of this type, in case some existing workflows already rely on that. We note that this is parallel and each rank will have a hexadata object with a portion of the total data.</p>
<p>Note that in our implementation, the hexadata object will always read the full file.</p>
<p>In general, this should not be the main way to initialize objects. But we give the option.</p>
<p>The steps that we follow to initialize are the following:</p>
<ol class="arabic simple">
<li><p>Read the hexadata object.</p></li>
<li><p>Initialize the mesh object from it</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1.</span>
<span class="n">data_2d</span> <span class="o">=</span> <span class="n">preadnek</span><span class="p">(</span><span class="n">fname_2d</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">data_dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>
<span class="n">data_3d</span> <span class="o">=</span> <span class="n">preadnek</span><span class="p">(</span><span class="n">fname_3d</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">data_dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">single</span><span class="p">)</span>
<span class="c1"># 2.</span>
<span class="n">msh_2d</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_2d</span><span class="p">,</span> <span class="n">create_connectivity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">msh_3d</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_3d</span><span class="p">,</span> <span class="n">create_connectivity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2024-10-04 11:15:27,693 - preadnek - INFO - Reading file: ../data/mixlay0.f00001
2024-10-04 11:15:27,767 - preadnek - INFO - Elapsed time: 0.07367152700000001s
2024-10-04 11:15:27,768 - preadnek - INFO - Reading file: ../data/rbc0.f00001
2024-10-04 11:15:27,803 - preadnek - INFO - Elapsed time: 0.034677242s
2024-10-04 11:15:27,804 - Mesh - INFO - Initializing Mesh object from HexaData object.
2024-10-04 11:15:27,811 - Mesh - INFO - Initializing common attributes.
2024-10-04 11:15:27,811 - Mesh - INFO - Getting vertices
2024-10-04 11:15:27,812 - Mesh - INFO - Getting edge centers
2024-10-04 11:15:27,818 - Mesh - INFO - Facet centers not available for 2D
2024-10-04 11:15:27,819 - Mesh - INFO - Creating connectivity
2024-10-04 11:15:28,163 - Mesh - INFO - Mesh object initialized.
2024-10-04 11:15:28,163 - Mesh - INFO - Mesh data is of type: float64
2024-10-04 11:15:28,164 - Mesh - INFO - Elapsed time: 0.360178777s
2024-10-04 11:15:28,171 - Mesh - INFO - Initializing Mesh object from HexaData object.
2024-10-04 11:15:28,175 - Mesh - INFO - Initializing common attributes.
2024-10-04 11:15:28,176 - Mesh - INFO - Getting vertices
2024-10-04 11:15:28,177 - Mesh - INFO - Getting edge centers
2024-10-04 11:15:28,186 - Mesh - INFO - Getting facet centers
2024-10-04 11:15:28,192 - Mesh - INFO - Creating connectivity
2024-10-04 11:15:28,572 - Mesh - INFO - Mesh object initialized.
2024-10-04 11:15:28,573 - Mesh - INFO - Mesh data is of type: float32
2024-10-04 11:15:28,573 - Mesh - INFO - Elapsed time: 0.40260753000000005s
</pre></div></div>
</div>
</section>
<section id="Initializing-from-an-ndarray">
<h2>Initializing from an ndarray<a class="headerlink" href="#Initializing-from-an-ndarray" title="Link to this heading"></a></h2>
<p>In some instances, one might create the SEM coordinates directly in python. If that is the case, starting directly from the coordinates as an array is also a possibility. One would first create an empty object and the initialize from coordinates as follow:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1.Copy the coordinates from before just to show</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">msh_3d</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">msh_3d</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">msh_3d</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

<span class="c1"># 2.Initialize a new mesh object</span>
<span class="n">msh_3d_sub</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">create_connectivity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">msh_3d_sub</span><span class="o">.</span><span class="n">init_from_coords</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2024-10-04 11:15:28,593 - Mesh - INFO - Initializing empty Mesh object.
2024-10-04 11:15:28,594 - Mesh - INFO - Initializing Mesh object from x,y,z ndarrays.
2024-10-04 11:15:28,595 - Mesh - INFO - Initializing common attributes.
2024-10-04 11:15:28,596 - Mesh - INFO - Getting vertices
2024-10-04 11:15:28,597 - Mesh - INFO - Getting edge centers
2024-10-04 11:15:28,608 - Mesh - INFO - Getting facet centers
2024-10-04 11:15:28,616 - Mesh - INFO - Creating connectivity
2024-10-04 11:15:29,080 - Mesh - INFO - Mesh object initialized.
2024-10-04 11:15:29,081 - Mesh - INFO - Mesh data is of type: float64
2024-10-04 11:15:29,081 - Mesh - INFO - Elapsed time: 0.48709318999999995s
</pre></div></div>
</div>
<p>In this case, just to show a simple manipulation, we casted the arrays from single to double precision</p>
<section id="Coef">
<h3>Coef<a class="headerlink" href="#Coef" title="Link to this heading"></a></h3>
<p>The coef object holds the jacobian matrix components, mass matrix and routines to perform derivatives and integrals in the SEM mesh. It is always initialized from a mesh object.</p>
<p>One aditional option for 3D meshes is to also obtain integration weights for the area of the facets in the SEM mesh. If you do not need it, do not activate it, as this takes some extra time and requires extra memory.</p>
<p>The data type of the coef object attributes will match the type of the mesh object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coef_2d</span> <span class="o">=</span> <span class="n">Coef</span><span class="p">(</span><span class="n">msh_2d</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">get_area</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">coef_3d</span> <span class="o">=</span> <span class="n">Coef</span><span class="p">(</span><span class="n">msh_3d</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">get_area</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2024-10-04 11:15:29,091 - Coef - INFO - Initializing Coef object
2024-10-04 11:15:29,092 - Coef - INFO - Getting derivative matrices
2024-10-04 11:15:29,094 - Coef - INFO - Calculating the components of the jacobian
2024-10-04 11:15:29,110 - Coef - INFO - Calculating the jacobian determinant and inverse of the jacobian matrix
2024-10-04 11:15:29,113 - Coef - INFO - Calculating the mass matrix
2024-10-04 11:15:29,114 - Coef - INFO - Coef object initialized
2024-10-04 11:15:29,114 - Coef - INFO - Coef data is of type: float64
2024-10-04 11:15:29,114 - Coef - INFO - Elapsed time: 0.023606959999999955s
2024-10-04 11:15:29,116 - Coef - INFO - Initializing Coef object
2024-10-04 11:15:29,117 - Coef - INFO - Getting derivative matrices
2024-10-04 11:15:29,121 - Coef - INFO - Calculating the components of the jacobian
2024-10-04 11:15:29,222 - Coef - INFO - Calculating the jacobian determinant and inverse of the jacobian matrix
2024-10-04 11:15:29,234 - Coef - INFO - Calculating the mass matrix
2024-10-04 11:15:29,235 - Coef - INFO - Calculating area weights and normal vectors
2024-10-04 11:15:29,255 - Coef - INFO - Coef object initialized
2024-10-04 11:15:29,256 - Coef - INFO - Coef data is of type: float32
2024-10-04 11:15:29,256 - Coef - INFO - Elapsed time: 0.14061485299999976s
</pre></div></div>
</div>
</section>
<section id="Field">
<h3>Field<a class="headerlink" href="#Field" title="Link to this heading"></a></h3>
<p>The field object is designed to hold the data from SEM fields in a way that intefacing to a nek5000 binary file is easily achieved.</p>
<p>The initialization can be done in similar ways as the mesh, i.e., by using hexadata and the pynekread routine.</p>
<section id="id1">
<h4>Initializing<a class="headerlink" href="#id1" title="Link to this heading"></a></h4>
</section>
</section>
</section>
<section id="Initializing-an-empty-object.">
<h2>Initializing an empty object.<a class="headerlink" href="#Initializing-an-empty-object." title="Link to this heading"></a></h2>
<p>We follow the same procedure to initialize an empty object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fld_2d</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">comm</span><span class="p">)</span>
<span class="n">fld_3d</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">comm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2024-10-04 11:15:29,263 - Field - INFO - Initializing empty Field object
2024-10-04 11:15:29,265 - Field - INFO - Initializing empty Field object
</pre></div></div>
</div>
</section>
<section id="id3">
<h2>Initializing from a file<a class="headerlink" href="#id3" title="Link to this heading"></a></h2>
<p>Using the pynekread routine, one can follow the same procedure. In this case, if only the fld file is indicated as input, the mesh in the file will not be read</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pynekread</span><span class="p">(</span><span class="n">fname_2d</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">data_dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">,</span> <span class="n">fld</span><span class="o">=</span><span class="n">fld_2d</span><span class="p">)</span>
<span class="n">pynekread</span><span class="p">(</span><span class="n">fname_3d</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">data_dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">single</span><span class="p">,</span> <span class="n">fld</span><span class="o">=</span><span class="n">fld_3d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2024-10-04 11:15:29,275 - pynekread - INFO - Reading file: ../data/mixlay0.f00001
2024-10-04 11:15:29,277 - pynekread - INFO - Reading field data
2024-10-04 11:15:29,282 - pynekread - INFO - File read
2024-10-04 11:15:29,283 - pynekread - INFO - Elapsed time: 0.007930652000000205s
2024-10-04 11:15:29,285 - pynekread - INFO - Reading file: ../data/rbc0.f00001
2024-10-04 11:15:29,287 - pynekread - INFO - Reading field data
2024-10-04 11:15:29,295 - pynekread - INFO - File read
2024-10-04 11:15:29,295 - pynekread - INFO - Elapsed time: 0.010863174999999892s
</pre></div></div>
</div>
<p>Note that you can read both mesh and fields with pynekread if you specify both keywords, i.e, msh= and fld=</p>
</section>
<section id="Initializing-from-hexadata">
<h2>Initializing from hexadata<a class="headerlink" href="#Initializing-from-hexadata" title="Link to this heading"></a></h2>
<p>Just as for the mesh, the same interface is valid.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1.</span>
<span class="n">data_2d</span> <span class="o">=</span> <span class="n">preadnek</span><span class="p">(</span><span class="n">fname_2d</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">data_dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>
<span class="n">data_3d</span> <span class="o">=</span> <span class="n">preadnek</span><span class="p">(</span><span class="n">fname_3d</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">data_dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">single</span><span class="p">)</span>
<span class="c1"># 2.</span>
<span class="n">fld_2d</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_2d</span><span class="p">)</span>
<span class="n">fld_3d</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_3d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2024-10-04 11:15:29,304 - preadnek - INFO - Reading file: ../data/mixlay0.f00001
2024-10-04 11:15:29,451 - preadnek - INFO - Elapsed time: 0.1472354819999997s
2024-10-04 11:15:29,455 - preadnek - INFO - Reading file: ../data/rbc0.f00001
2024-10-04 11:15:29,491 - preadnek - INFO - Elapsed time: 0.035575633000000106s
2024-10-04 11:15:29,493 - Field - INFO - Initializing Field object from HexaData
2024-10-04 11:15:29,508 - Field - INFO - Field object initialized
2024-10-04 11:15:29,509 - Field - INFO - Elapsed time: 0.015144010000000208s
2024-10-04 11:15:29,509 - Field - INFO - Initializing Field object from HexaData
2024-10-04 11:15:29,515 - Field - INFO - Field object initialized
2024-10-04 11:15:29,515 - Field - INFO - Elapsed time: 0.006332111999999945s
</pre></div></div>
</div>
<p>The field object contains all the information in a subdirectory called fields that is divided into the conventions of a nek5000 binary format.</p>
<p>The keywords are:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">fld_2d</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1"> has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">fld_2d</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="si">}</span><span class="s1"> fields&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=================&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">fld_3d</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1"> has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">fld_3d</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="si">}</span><span class="s1"> fields&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
vel has 2 fields
pres has 1 fields
temp has 1 fields
scal has 2 fields
=================
vel has 3 fields
pres has 1 fields
temp has 1 fields
scal has 0 fields
</pre></div></div>
</div>
<p>Each keword has a list of fields depending on the contents of the file. Note how the 2 files that we test here have different information.</p>
<p>To access the content of the files, one can do something like this:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">fld_3d</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;vel&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">fld_3d</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;vel&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">fld_3d</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;vel&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">fld_3d</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;pres&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">fld_3d</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>If one wishes to add new data, it is as simple as appending arrays to any of the keys of the field object. Given that nek5000 readers follow certain logic, it is always safer to add new data to the scalars, unless one wishes to overwrite velocity, pressure, and/or temperature.</p>
<p>For example, we can add the velocity magnitude as a scalar with:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">v</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fld_3d</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;scal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mag</span><span class="p">)</span>
<span class="n">fld_3d</span><span class="o">.</span><span class="n">update_vars</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>If one adds new data, it is needed that one calls the update_vars method to update the attributes that keep track of the number of fields in the field object. This is needed, for example, if one wishes to write data to disk.</p>
<section id="Writing-out-data">
<h3>Writing out data<a class="headerlink" href="#Writing-out-data" title="Link to this heading"></a></h3>
<p>Writing the data out always needs a mesh and field object, even if one does not wish to write the mesh out.</p>
<p>The procedure is as simple as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fname_out</span> <span class="o">=</span> <span class="s1">&#39;../data/out_rbc0.f00001&#39;</span>

<span class="n">pynekwrite</span><span class="p">(</span><span class="n">fname_out</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">msh</span><span class="o">=</span><span class="n">msh_3d</span><span class="p">,</span> <span class="n">fld</span><span class="o">=</span><span class="n">fld_3d</span><span class="p">,</span> <span class="n">write_mesh</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wdsz</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2024-10-04 11:15:29,554 - pynekwrite - INFO - Writing file: ../data/out_rbc0.f00001
2024-10-04 11:15:29,565 - pynekwrite - INFO - Elapsed time: 0.010662473000000006s
</pre></div></div>
</div>
</section>
<section id="Field-registry">
<h3>Field registry<a class="headerlink" href="#Field-registry" title="Link to this heading"></a></h3>
<p>The field registry is a class that extends the field class. We believe this is the class that should be used instead of fields, as it allows to do the same things, but with some extra flexibility.</p>
<p>The methods to initialize it and write data with it are the same. It also contains the fields attribute with a list of the present fields.</p>
<p>It however, has an additional registry attribute that names and points to each field.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fld_3d_r</span> <span class="o">=</span> <span class="n">FieldRegistry</span><span class="p">(</span><span class="n">comm</span><span class="p">)</span>
<span class="n">pynekread</span><span class="p">(</span><span class="n">fname_3d</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">data_dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">single</span><span class="p">,</span> <span class="n">fld</span><span class="o">=</span><span class="n">fld_3d_r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2024-10-04 11:15:29,575 - Field - INFO - Initializing empty Field object
2024-10-04 11:15:29,577 - pynekread - INFO - Reading file: ../data/rbc0.f00001
2024-10-04 11:15:29,579 - pynekread - INFO - Reading field data
2024-10-04 11:15:29,582 - pynekread - INFO - File read
2024-10-04 11:15:29,584 - pynekread - INFO - Elapsed time: 0.006489980999999645s
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">fld_3d_r</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1"> has </span><span class="si">{</span><span class="n">fld_3d_r</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s1"> dtype&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
u has float32 dtype
v has float32 dtype
w has float32 dtype
p has float32 dtype
t has float32 dtype
</pre></div></div>
</div>
<p>Note that all the fields that have been adressed as indices in a list have now been assigned names.</p>
<section id="Adding-new-fields">
<h4>Adding new fields<a class="headerlink" href="#Adding-new-fields" title="Link to this heading"></a></h4>
</section>
</section>
</section>
<section id="From-memory">
<h2>From memory<a class="headerlink" href="#From-memory" title="Link to this heading"></a></h2>
<p>Adding new fields can now also been done very easy as well. Here we can add a new field named mag that is the velocity magnitude calculated earlier.</p>
<p>This field will be added as an scalar to the fields attribute.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fld_3d_r</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">field_name</span><span class="o">=</span><span class="s1">&#39;mag&#39;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="n">mag</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">mag</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Field mag added to registry and fields directory in pos </span><span class="si">{</span><span class="n">fld_3d_r</span><span class="o">.</span><span class="n">registry_pos</span><span class="p">[</span><span class="s2">&quot;mag&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Field mag added to registry and fields directory in pos scal_0
</pre></div></div>
</div>
</section>
<section id="From-disk">
<h2>From disk<a class="headerlink" href="#From-disk" title="Link to this heading"></a></h2>
<p>You can also just read one field from a file, which reduces the memory footprint.</p>
<p>The procesude is shown below, note that here we know that we have written the field mag as an scalar.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fld_3d_r</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">field_name</span><span class="o">=</span><span class="s1">&#39;mag_r&#39;</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="n">fname_out</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s1">&#39;fld&#39;</span><span class="p">,</span> <span class="n">file_key</span><span class="o">=</span><span class="s1">&#39;scal_0&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">mag</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Field mag_r added to registry and fields directory in pos </span><span class="si">{</span><span class="n">fld_3d_r</span><span class="o">.</span><span class="n">registry_pos</span><span class="p">[</span><span class="s2">&quot;mag_r&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2024-10-04 11:15:29,613 - pynekread_field - INFO - Reading field: scal_0 from file: ../data/out_rbc0.f00001
2024-10-04 11:15:29,624 - pynekread_field - INFO - File read
2024-10-04 11:15:29,629 - pynekread_field - INFO - Elapsed time: 0.016024912999999863s
Field mag_r added to registry and fields directory in pos scal_1
</pre></div></div>
</div>
<p>Let’s compare the field that we previously wrote with the one we calculated</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">fld_3d_r</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">],</span> <span class="n">fld_3d_r</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="s1">&#39;mag_r&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<p>In our implementation, each member of the registry is linked to a member of the lists contained in the fields attribute.</p>
<p>For the link to be mantained, we must modify the registry in place, not reassing fields to it.</p>
<p>If you would like to replace an entry in the field registry, then use the add field method with the same key</p>
<p>Lets experiment adding a field full of ones. Based on the order of our operations, we know it is stored in scal 2. You can also check the registry_pos attribute:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fld_3d_r</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">field_name</span><span class="o">=</span><span class="s1">&#39;ones&#39;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">mag</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">mag</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fld_3d_r</span><span class="o">.</span><span class="n">registry_pos</span><span class="p">[</span><span class="s1">&#39;ones&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fld_3d_r</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="s1">&#39;ones&#39;</span><span class="p">][</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fld_3d_r</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;scal&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
scal_2
[[1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]]
[[1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]]
</pre></div></div>
</div>
<p>If I modify the registry, the list is modified:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fld_3d_r</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="s1">&#39;ones&#39;</span><span class="p">][</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fld_3d_r</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;scal&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[2. 2. 2. 2. 2. 2. 2. 2.]
 [2. 2. 2. 2. 2. 2. 2. 2.]
 [2. 2. 2. 2. 2. 2. 2. 2.]
 [2. 2. 2. 2. 2. 2. 2. 2.]
 [2. 2. 2. 2. 2. 2. 2. 2.]
 [2. 2. 2. 2. 2. 2. 2. 2.]
 [2. 2. 2. 2. 2. 2. 2. 2.]
 [2. 2. 2. 2. 2. 2. 2. 2.]]
</pre></div></div>
</div>
<p>The same happens in the opposite direction</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fld_3d_r</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;scal&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fld_3d_r</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="s1">&#39;ones&#39;</span><span class="p">][</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[3. 3. 3. 3. 3. 3. 3. 3.]
 [3. 3. 3. 3. 3. 3. 3. 3.]
 [3. 3. 3. 3. 3. 3. 3. 3.]
 [3. 3. 3. 3. 3. 3. 3. 3.]
 [3. 3. 3. 3. 3. 3. 3. 3.]
 [3. 3. 3. 3. 3. 3. 3. 3.]
 [3. 3. 3. 3. 3. 3. 3. 3.]
 [3. 3. 3. 3. 3. 3. 3. 3.]]
</pre></div></div>
</div>
<p>However if you try to assing a field directly to the registry, you will get an error:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">mag</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">fld_3d_r</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="s1">&#39;ones&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeros</span>
<span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#34;Key &#39;ones&#39; already exists. Cannot overwrite existing array without the add field method&#34;
</pre></div></div>
</div>
<p>But see that if you add the field again with the proper method, then it should work as you want</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fld_3d_r</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">field_name</span><span class="o">=</span><span class="s1">&#39;ones&#39;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="n">zeros</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">zeros</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fld_3d_r</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;scal&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2024-10-04 11:15:29,750 - Field - WARNING - Field ones already in registry. Overwriting
[[0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]]
</pre></div></div>
</div>
<section id="Wrappers">
<h3>Wrappers<a class="headerlink" href="#Wrappers" title="Link to this heading"></a></h3>
<p>In the event that all you want is a numpy array with the data, you can also use a wrapper to retrieve the data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pynektools.io.wrappers</span> <span class="kn">import</span> <span class="n">read_data</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">read_data</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">fname_out</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;scal_0&quot;</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">single</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2024-10-04 11:15:29,791 - Field - INFO - Initializing empty Field object
2024-10-04 11:15:29,792 - Mesh - INFO - Initializing empty Mesh object.
2024-10-04 11:15:29,792 - pynekread - INFO - Reading file: ../data/out_rbc0.f00001
2024-10-04 11:15:29,797 - Mesh - INFO - Initializing Mesh object from x,y,z ndarrays.
2024-10-04 11:15:29,798 - Mesh - INFO - Initializing common attributes.
2024-10-04 11:15:29,798 - Mesh - INFO - Getting vertices
2024-10-04 11:15:29,799 - Mesh - INFO - Getting edge centers
2024-10-04 11:15:29,810 - Mesh - INFO - Getting facet centers
2024-10-04 11:15:29,817 - Mesh - INFO - Creating connectivity
2024-10-04 11:15:30,204 - Mesh - INFO - Mesh object initialized.
2024-10-04 11:15:30,205 - Mesh - INFO - Mesh data is of type: float32
2024-10-04 11:15:30,206 - Mesh - INFO - Elapsed time: 0.40879251299999986s
2024-10-04 11:15:30,207 - pynekread - INFO - File read
2024-10-04 11:15:30,207 - pynekread - INFO - Elapsed time: 0.4150390530000001s
2024-10-04 11:15:30,209 - pynekread_field - INFO - Reading field: scal_0 from file: ../data/out_rbc0.f00001
2024-10-04 11:15:30,212 - pynekread_field - INFO - File read
2024-10-04 11:15:30,212 - pynekread_field - INFO - Elapsed time: 0.003471009999999719s
</pre></div></div>
</div>
<p>data is a dictionary that contains the data of the keys that were given.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="n">msh_3d</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">msh_3d</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">],</span> <span class="n">msh_3d</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;scal_0&quot;</span><span class="p">],</span> <span class="n">fld_3d_r</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="s1">&#39;mag_r&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
True
True
True
</pre></div></div>
</div>
</section>
<section id="Inspecting-memory-usage">
<h3>Inspecting memory usage<a class="headerlink" href="#Inspecting-memory-usage" title="Link to this heading"></a></h3>
<p>To inspect the memory usage, one can use the monitoring module</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pynektools.monitoring.memory_monitor</span> <span class="kn">import</span> <span class="n">MemoryMonitor</span>

<span class="n">mm</span> <span class="o">=</span> <span class="n">MemoryMonitor</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>You can chose to inspect the total memory used, or check the ussage of each attibute.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mm</span><span class="o">.</span><span class="n">object_memory_usage</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">msh_3d</span><span class="p">,</span> <span class="s2">&quot;mesh_3d&quot;</span><span class="p">,</span> <span class="n">print_msg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">mm</span><span class="o">.</span><span class="n">object_memory_usage_per_attribute</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">msh_3d</span><span class="p">,</span> <span class="s2">&quot;mesh_3d&quot;</span><span class="p">,</span> <span class="n">print_msg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">mm</span><span class="o">.</span><span class="n">object_memory_usage</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">coef_3d</span><span class="p">,</span> <span class="s2">&quot;coef_3d&quot;</span><span class="p">,</span> <span class="n">print_msg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">mm</span><span class="o">.</span><span class="n">object_memory_usage_per_attribute</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">coef_3d</span><span class="p">,</span> <span class="s2">&quot;coef_3d&quot;</span><span class="p">,</span> <span class="n">print_msg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">mm</span><span class="o">.</span><span class="n">object_memory_usage</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">fld_3d_r</span><span class="p">,</span> <span class="s2">&quot;fld_3d&quot;</span><span class="p">,</span> <span class="n">print_msg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">mm</span><span class="o">.</span><span class="n">object_memory_usage_per_attribute</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">fld_3d_r</span><span class="p">,</span> <span class="s2">&quot;fld_3d&quot;</span><span class="p">,</span> <span class="n">print_msg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Report">
<h4>Report<a class="headerlink" href="#Report" title="Link to this heading"></a></h4>
<p>Report the information.</p>
<p>Note that for field registry objects, the information of registry and field will appear as duplicate. We have seen howeverm that they point to the sampe places in memory, therefore no need to worry about memory duplication.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">comm</span><span class="o">.</span><span class="n">Get_rank</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">mm</span><span class="o">.</span><span class="n">object_report</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">mm</span><span class="o">.</span><span class="n">report_object_information</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;===================================&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Rank: 0 - Memory usage of mesh_3d: 25.399681091308594 MB
Rank: 0 - Memory usage of mesh_3d attributes:
Rank: 0 - Memory usage of mesh_3d attr - coord_hash_to_shared_map: 21.699501037597656 MB
Rank: 0 - Memory usage of mesh_3d attr - create_connectivity_bool: 3.0517578125e-05 MB
Rank: 0 - Memory usage of mesh_3d attr - edge_centers: 0.082550048828125 MB
Rank: 0 - Memory usage of mesh_3d attr - facet_centers: 0.041351318359375 MB
Rank: 0 - Memory usage of mesh_3d attr - gdim: 3.0517578125e-05 MB
Rank: 0 - Memory usage of mesh_3d attr - glb_nelv: 4.57763671875e-05 MB
Rank: 0 - Memory usage of mesh_3d attr - global_element_number: 0.004730224609375 MB
Rank: 0 - Memory usage of mesh_3d attr - lx: 4.57763671875e-05 MB
Rank: 0 - Memory usage of mesh_3d attr - lxyz: 4.57763671875e-05 MB
Rank: 0 - Memory usage of mesh_3d attr - ly: 4.57763671875e-05 MB
Rank: 0 - Memory usage of mesh_3d attr - lz: 4.57763671875e-05 MB
Rank: 0 - Memory usage of mesh_3d attr - nelv: 4.57763671875e-05 MB
Rank: 0 - Memory usage of mesh_3d attr - offset_el: 4.57763671875e-05 MB
Rank: 0 - Memory usage of mesh_3d attr - vertices: 0.055084228515625 MB
Rank: 0 - Memory usage of mesh_3d attr - x: 1.172027587890625 MB
Rank: 0 - Memory usage of mesh_3d attr - y: 1.172027587890625 MB
Rank: 0 - Memory usage of mesh_3d attr - z: 1.172027587890625 MB
===================================
Rank: 0 - Memory usage of coef_3d: 26.96227264404297 MB
Rank: 0 - Memory usage of coef_3d attributes:
Rank: 0 - Memory usage of coef_3d attr - B: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - apply_1d_operators: 3.0517578125e-05 MB
Rank: 0 - Memory usage of coef_3d attr - area: 0.879058837890625 MB
Rank: 0 - Memory usage of coef_3d attr - dn: 0.000396728515625 MB
Rank: 0 - Memory usage of coef_3d attr - dr: 0.000396728515625 MB
Rank: 0 - Memory usage of coef_3d attr - drdx: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - drdy: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - drdz: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - ds: 0.000396728515625 MB
Rank: 0 - Memory usage of coef_3d attr - dsdx: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - dsdy: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - dsdz: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - dt: 0.000396728515625 MB
Rank: 0 - Memory usage of coef_3d attr - dtdx: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - dtdy: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - dtdz: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - dtype: 0.00011444091796875 MB
Rank: 0 - Memory usage of coef_3d attr - dxdr: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - dxds: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - dxdt: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - dydr: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - dyds: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - dydt: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - dzdr: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - dzds: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - dzdt: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - gdim: 3.0517578125e-05 MB
Rank: 0 - Memory usage of coef_3d attr - jac: 1.172027587890625 MB
Rank: 0 - Memory usage of coef_3d attr - nx: 0.879058837890625 MB
Rank: 0 - Memory usage of coef_3d attr - ny: 0.879058837890625 MB
Rank: 0 - Memory usage of coef_3d attr - nz: 0.879058837890625 MB
Rank: 0 - Memory usage of coef_3d attr - v: 0.000396728515625 MB
Rank: 0 - Memory usage of coef_3d attr - vinv: 0.000396728515625 MB
Rank: 0 - Memory usage of coef_3d attr - w: 0.0004119873046875 MB
Rank: 0 - Memory usage of coef_3d attr - w3: 0.002105712890625 MB
Rank: 0 - Memory usage of coef_3d attr - x: 0.0004119873046875 MB
===================================
Rank: 0 - Memory usage of fld_3d: 18.75537109375 MB
Rank: 0 - Memory usage of fld_3d attributes:
Rank: 0 - Memory usage of fld_3d attr - fields: 9.376884460449219 MB
Rank: 0 - Memory usage of fld_3d attr - pres_fields: 3.0517578125e-05 MB
Rank: 0 - Memory usage of fld_3d attr - registry: 9.376899719238281 MB
Rank: 0 - Memory usage of fld_3d attr - registry_pos: 0.00119781494140625 MB
Rank: 0 - Memory usage of fld_3d attr - scal_fields: 3.0517578125e-05 MB
Rank: 0 - Memory usage of fld_3d attr - scal_fields_names: 0.000244140625 MB
Rank: 0 - Memory usage of fld_3d attr - t: 2.288818359375e-05 MB
Rank: 0 - Memory usage of fld_3d attr - temp_fields: 3.0517578125e-05 MB
Rank: 0 - Memory usage of fld_3d attr - vel_fields: 3.0517578125e-05 MB
===================================
</pre></div></div>
</div>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../pages/io.html" class="btn btn-neutral float-left" title="InputOutput (I/O)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="2-sem_subdomains.html" class="btn btn-neutral float-right" title="Sem subdomains" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Neko authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>